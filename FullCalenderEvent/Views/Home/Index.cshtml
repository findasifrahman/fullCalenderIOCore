@model IEnumerable<FullCalenderEvent.Models.eventDday>
@{
    ViewBag.Title = "Index";
}
<style>
  body {
    margin: 0;
    padding: 0;
    font-size: 14px;
    background-color:black
  }

  #top,
  #calendar.fc-unthemed {
    font-family: Arial, Helvetica Neue, Helvetica, sans-serif;
  }
    .fc-today {
      @*background-color: lawngreen  !important;*@
    }


  #top {
    background: #eee;
    border-bottom: 1px solid #ddd;
    padding: 0 10px;
    line-height: 40px;
    font-size: 12px;
    color: #000;
  }

  #top .selector {
    display: inline-block;
    margin-right: 10px;
  }

  #top select {
    font: inherit; /* mock what Boostrap does, don't compete  */
  }

  .left { float: left }
  .right { float: right }
  .clear { clear: both }

  #calendar {
    max-width: 1100px;
    margin: 40px auto;
    padding: 0 10px;
    font-size:small;
    background-color:black;
    color:yellow;
  }

</style>

<div id="throbber" style="display:none; min-height:80px;"></div>
<div id="noty-holder"></div>
<div id="wrapper">

        <!-- Sidebar Menu Items - These collapse to the responsive navigation menu on small screens -->
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav side-nav">
                <li>
                    <a href="/home/index" data-toggle="collapse" data-target="#submenu-2" style="color:white;font-weight:bolder;"><i class="fa fa-fw fa-fw"></i> All Running Event <i class="fa fa-fw fa-angle-down pull-right"></i></a>
                    <ul id="submenu-2" class="collapse">
                    </ul>
                </li>
                @if (ViewBag.dlist != null)
                {
                    foreach (var item in ViewBag.dlist)
                    {
                        <li>
                            <a href="/home/index?Id=@item.Id" data-toggle="collapse" data-target="#submenu-1" style="color:whitesmoke"><i class="fa fa-fw fa-search"></i> @item.EventDay <i class="fa fa-fw fa-angle-down pull-right"></i></a>
                            <ul id="submenu-1" class="collapse">
                                <li><a href="#"><i class="fa fa-angle-double-right"></i> SUBMENU 1.1</a></li>
                            </ul>
                        </li>
                    }
                }

            </ul>
        </div>

    <!-- /#page-wrapper -->
</div><!-- /#wrapper -->

<h3>Event Calender DNT Bangladesh Navy</h3>

<div id="calendar" style="padding-left:80px !important"></div>



<div id="myModal" class="modal fade"  role="dialog">
    <div class="modal-dialog" >
        <div class="modal-content" style="background-color:dodgerblue">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title" style="color:orangered"><span id="eventTitle"></span></h4>
            </div>
            <div class="modal-body">
                @*<button id="btnDelete" class="btn btn-default btn-sm pull-right">
                        <span class="glyphicon glyphicon-remove"></span> Remove
                    </button>
                    <button id="btnEdit" class="btn btn-default btn-sm pull-right" style="margin-right:5px;">
                        <span class="glyphicon glyphicon-pencil"></span> Edit
                    </button>*@
                <p id="pDetails"></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<link href='https://use.fontawesome.com/releases/v5.0.6/css/all.css' rel='stylesheet'>
<link href='~/Scripts/core/main.css' rel='stylesheet' />
<link href='~/Scripts/bootstrap/main.css' rel='stylesheet' />
<link href='~/Scripts/daygrid/main.css' rel='stylesheet' />
<link href='~/Scripts/list/main.css' rel='stylesheet' />


@section Scripts{
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>

    <script src='~/Scripts/core/main.js'></script>
    <script src='~/Scripts/interaction/main.js'></script>
    <script src='~/Scripts/bootstrap/main.js'></script>
    <script src='~/Scripts/daygrid/main.js'></script>
    <script src='~/Scripts/timegrid/main.js'></script>
    <script src='~/Scripts/list/main.js'></script>
    <script src='~/Scripts/google-calendar/main.js'></script>
    <script src='~/Scripts/theme-chooser.js'></script>


    <script>
        document.addEventListener('DOMContentLoaded', function () {
            var calendarEl = document.getElementById('calendar');
            var calendar;
            var events = [];
            var selectedEvent = null;
            FetchEventAndRenderCalendar();
            function FetchEventAndRenderCalendar() {
                var ss =  @Html.Raw(Json.Encode(ViewBag.curdate));
                var defdate = "2019-02-01";
                if(ss != null){
                    defdate = new Date(parseInt(ss.replace("/Date(", "").replace(")/",""), 10));
                }
                //alert(defdate);
                events = [];
               $.ajax({
                    type: "GET",
                    url: "/eventDdays/dDayDetails",//"/home/GetEvents",
                    success: function (data) {

                        var arr =  @Html.Raw(Json.Encode(Model));

                        $.each(arr, function (i, v) {
                            console.log(v.DdayDetails[0]);
                            var stdate = new Date(parseInt(v.Dday.replace("/Date(", "").replace(")/",""), 10));
                            var tmphour = stdate.getHours().toString();
                            var tmpmin = stdate.getMinutes().toString();
                            if(parseInt(tmphour)<=9){
                                tmphour = "0" + tmphour;
                            }
                            if(parseInt(tmpmin)<=9){
                                tmpmin = "0" + tmpmin;
                            }
                            var sttime = tmphour+tmpmin;
                            var titlee = v.EventDay;
                            if(!v.isFullDayMain){
                                titlee = sttime + "-" + titlee;
                            }
                            var col = null;
                            if(v.DdayDetails != null){
                                col = v.mainColor;//v.DdayDetails[0].Color
                            }
                            //alert(orderdate);
                            events.push({
                                //eventID: v.Id,
                                 title: titlee,//sttime + "-" + v.EventDay,
                                 groupId: v.DdayDetails,
                                 start: stdate,
                                 //end: enddate,// != null ? enddate : null,
                                 color: col,
                                 url: "/home/Details/" + v.Id,
                                 allDay: true//v.isFullDayMain
                            });
                        })

                       // var calendarEl = document.getElementById('calendar');
                       calendar = new FullCalendar.Calendar(calendarEl, {
                           plugins: ['interaction', 'dayGrid', 'timeGrid', 'list', 'bootstrap'],
                           axisFormat: 'HH:mm',
                           timeFormat: 'HH:mm{ - HH:mm}',
                           minTime: 0,
                           maxTime: 24,
                           themeSystem: 'standard',//themeSystem,
                           defaultDate: defdate,
                           height:550,
                            header: {
                                left: 'prev,next today',
                                center: 'title',
                                right: 'dayGridMonth,dayGridWeek,dayGridDay,listWeek'
                            },
                            views: {
                                dayGridMonth: {
                                    axisFormat: 'H:mm',
                                    timeFormat: 'H:mm'

                                },
                                listDay: { buttonText: 'list day' },
                                listWeek: { buttonText: 'list week' }
                            },
                            //defaultDate: '2019-04-12',
                            weekNumbers: false,
                            editable: true,
                            navLinks: true, // can click day/week names to navigate views
                            eventLimit: true, // allow "more" link when too many events
                            events: events,
                            googleCalendarApiKey: 'AIzaSyDRd5OUMhBnK8egGHi3PIGDs7VMHpkZt3o',
                           // US Holidays
                            //eventSources: [/*'findasifrahman@gmail.com',*/ /*'en.usa#holiday@group.v.calendar.google.com'*/  'en.bd#holiday@group.v.calendar.google.com'],
                            eventClick: function (info) {
                                //alert('Event: ' + info.event.groupId);

                                /*selectedEvent = info;
                                $('#myModal #eventTitle').text(info.event.title);
                                var $description = $('<div/>');
                                $description.append($('<p style="color:white"/>').html('<b>Start : </b>' + info.event.start.toString("")));
                                if (info.event.end != null) {
                                    $description.append($('<p style="color:yellow"/>').html('<b>End : </b>' + info.event.end.toString()));
                                }
                                $description.append($('<p style="color:yellow;font-Size:large" />').html('<b style="color:white;font-Size:large">Description : </b>' + info.event.groupId));
                                $('#myModal #pDetails').empty().html($description);

                                $('#myModal').modal();
                                info.el.style.borderColor = 'red';*/
                            }
                        });

                        calendar.render();
                    },
                    error: function (error) {
                        alert('failed to find server');
                    }
                })
            }

        })
    </script>
}
